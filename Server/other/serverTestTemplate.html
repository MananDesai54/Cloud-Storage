<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.20.0/axios.min.js"></script>
  </head>

  <body>
    <a
      href="https://cloud-storage-uploads.s3.amazonaws.com/38fda780-c169-4122-8c34-2585dde29622.png"
      >Show</a
    >
    <button id="download">Download File</button>
    <form>
      <input type="file" name="file" id="file" />
      <button type="submit">Upload</button>
    </form>
    <input
      type="file"
      name="folder"
      id="folder"
      webkitdirectory
      mozdirectory
      msdirectory
      odirectory
      directory
      multiple
    />
    <img src="" alt="Please upload to S3" />
    <button id="login">login</button>
    <script>
      let input = document.querySelector("#file");
      let folder = document.querySelector("#folder");
      let login = document.querySelector("#login");
      login.addEventListener("click", (e) => {
        fetch("http://localhost:5000/api/auth", {
          method: "POST",
          body: JSON.stringify({
            email: "manan5401desai@gmail.com",
            password: "Manan@5401",
          }),
          headers: {
            "Content-type": "application/json",
          },
        })
          .then((res) => res.json())
          .then((data) => console.log(data));
      });
      input.addEventListener("change", (e) => console.log(input.files[0]));
      folder.addEventListener("change", (e) => {
        [...e.target.files].forEach((file) => {
          console.log(file);
        });
      });
      document.getElementById("download").addEventListener("click", (e) => {
        axios(
          "http://localhost:5000/api/cloud/download/5f9a4849d92e4d241c125587",
          {
            method: "GET",
            headers: {
              "x-auth-token":
                "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjoiNWY5YTQ2OTVmMWMwNDk0ODZjZTI1ODNjIn0sImlhdCI6MTYwNDAzNDg1NSwiZXhwIjoxNjA0MTIxMjU1fQ.QmBH3nalJv-4EK6ros35vUm-6Fn7fMgcgVrS6ecqbbw",
            },
            responseType: "blob",
          }
        )
          .then((res) => {
            console.log(res.data);
            const blob = new Blob([res.data], { type: res.data.type });
            const url = window.URL.createObjectURL(blob);
            console.log(url);
            const link = document.createElement("a");
            link.href = url;
            link.setAttribute(
              "download",
              `file.${res.data.type.split("/")[1]}`
            );
            document.body.appendChild(link);
            link.textContent = "hey";
            window.open(url);
          })
          //.then((data) => console.log(data))
          .catch((err) => console.log(err.message));
      });
      document.querySelector("form").addEventListener("submit", (e) => {
        e.preventDefault();
        console.log(input.files[0]);
        const fd = new FormData();
        fd.append("file", input.files[0]);
        fetch("http://localhost:5000/api/cloud/file/root", {
          method: "POST",
          body: fd,
          headers: {
            /*'Content-type': 'multipart/form-data; boundary=<calculated when request is sent>',*/
            "x-auth-token":
              "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjoiNWY3MWU4NTI5NWU1ZjEwOTBjMzlkYTY3In0sImlhdCI6MTYwMTMxMzQ1NCwiZXhwIjoxNjAxMzk5ODU0fQ.WQBc5wCohhbSJ_N8dNpXu0v09sNV1zPYwXlYupJ6CNk",
          },
        }).then((res) => console.log(res));
        //.then((data) => {
        //console.log(data);
        //console.log(data.data.Location);
        //if(data.data.Location) {
        //   document.querySelector('img').src = data.data.Location;
        //}
        //});
      });
    </script>
  </body>
</html>

<!-- <button>Sign up with google</button>
<script>
    document.querySelector('button').addEventListener('click', (e) => {
        fetch('http://localhost:5000/api/users/google')
            .then(res => res.json())
            .then(data => console.log(data))
            .catch(err => console.log(err));
    });
</script> --->
